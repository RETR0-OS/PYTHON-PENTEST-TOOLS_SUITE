#!/usr/bin/python3

import subprocess, sys

wordlist = input("Enter path to wordlist: ")
img = input("Enter path to image to bruteforce: ")

with open(wordlist, "r") as file:
	for line in file:
		word = file.readline()
		word = word.strip()
		print(word)
		print(f"trying {word}")
		try:
			command = f"steghide extract -sf {img} -p {word}"
			print(command)
			result = subprocess.check_output(command, shell=True)
			if "could not extract" not in result:
				print(f"Found passphrase --> {word}")
				print("Printing extracted data!\n")
				print(result)
				exit()
		except Exception:
			pass
